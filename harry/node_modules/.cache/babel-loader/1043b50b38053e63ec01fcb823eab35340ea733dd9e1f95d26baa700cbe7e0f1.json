{"ast":null,"code":"var _jsxFileName = \"D:\\\\Github\\\\KaKao\\\\harry\\\\src\\\\components\\\\createSection\\\\Preview.jsx\",\n  _s = $RefreshSig$();\nimport React, { useRef, useEffect, useState } from 'react';\nimport Styles from './preview.module.css';\nimport img1 from '../../imgs/img1.png';\nimport img2 from '../../imgs/img2.png';\nimport img3 from '../../imgs/img3.png';\nimport img4 from '../../imgs/img4.png';\nimport img5 from '../../imgs/img5.png';\nimport img6 from '../../imgs/img6.png';\nimport img7 from '../../imgs/img7.png';\nimport img8 from '../../imgs/img8.png';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst imgArr = [img1, img2, img3, img4, img5, img6, img7, img8];\nconst heightArr = [];\nlet canv1W;\nlet canv1H;\nconst defaultMessageStyle = {\n  top: `0px`,\n  opacity: 0\n};\nconst s1HeightSize = 5;\nconst sceneActive = {\n  s1: {\n    intro: {\n      img: img8\n    },\n    opAction: {\n      opacityIn: [0, 1],\n      opacityOut: [1, 0],\n      opacityInRatio: [0, 0.1],\n      opacityOutRatio: [0.9, 1]\n    },\n    img1: {\n      drawRangeX: '',\n      drawRangeY: '',\n      drawIn: [0.15, 0.2],\n      drawOut: [0.3, 0.4]\n    },\n    img2: {\n      drawRangeX: '',\n      drawRangeY: '',\n      drawIn: [0.35, 0.4],\n      drawOut: [0.5, 0.6]\n    },\n    img3: {\n      drawRangeX: '',\n      drawRangeY: '',\n      drawIn: [0.55, 0.6],\n      drawOut: [0.65, 0.75]\n    },\n    img4: {\n      drawRangeX: '',\n      drawRangeY: '',\n      drawIn: [0.7, 0.75],\n      drawOut: [0.8, 0.85]\n    },\n    messages: [{\n      context: 'hello!',\n      opIn: [0, 0.05],\n      opOut: [0.15, 0.2],\n      trIn: [20, 0],\n      trOut: [0, -20],\n      color: 'black',\n      size: 'large',\n      sort: 'middle'\n    }, {\n      context: '잘 지냄 수과',\n      opIn: [0.2, 0.25],\n      opOut: [0.35, 0.4],\n      trIn: [20, 0],\n      trOut: [0, -20],\n      color: 'black',\n      size: 'large',\n      sort: 'middle'\n    }, {\n      context: '나도 잘 지내영',\n      opIn: [0.4, 0.45],\n      opOut: [0.55, 0.6],\n      trIn: [20, 0],\n      trOut: [0, -20],\n      color: 'black',\n      size: 'large',\n      sort: 'middle'\n    }, {\n      context: '잘 지냄 수과',\n      opIn: [0.6, 0.65],\n      opOut: [0.75, 0.8],\n      trIn: [20, 0],\n      trOut: [0, -20],\n      color: 'black',\n      size: 'large',\n      sort: 'middle'\n    }]\n  }\n};\nconst paintImage = (sRatio, ctx, rangeInfo, paintImg) => {\n  const paintingBorder = (rangeInfo.drawIn[1] + rangeInfo.drawOut[0]) / 2;\n  if (sRatio < paintingBorder) {\n    let drawCX = canv1W * (sRatio - rangeInfo.drawIn[0]) / (rangeInfo.drawIn[1] - rangeInfo.drawIn[0]);\n    let drawIX = (rangeInfo.drawRangeX[1] - rangeInfo.drawRangeX[0]) * (sRatio - rangeInfo.drawIn[0]) / (rangeInfo.drawIn[1] - rangeInfo.drawIn[0]);\n    if (drawCX < 0) drawCX = 0;else if (drawCX > canv1W) drawCX = canv1W;\n    if (drawIX < 0) drawIX = 0;else if (drawIX > rangeInfo.drawRangeX[1] - rangeInfo.drawRangeX[0]) drawIX = rangeInfo.drawRangeX[1] - rangeInfo.drawRangeX[0];\n    ctx.drawImage(paintImg, rangeInfo.drawRangeX[0], rangeInfo.drawRangeY[0], drawIX, rangeInfo.drawRangeY[1] - rangeInfo.drawRangeY[0], 0, 0, drawCX, canv1H);\n  } else {\n    let drawCX = canv1W * (sRatio - rangeInfo.drawOut[0]) / (rangeInfo.drawOut[1] - rangeInfo.drawOut[0]);\n    let drawIX = (rangeInfo.drawRangeX[1] - rangeInfo.drawRangeX[0]) * (sRatio - rangeInfo.drawOut[0]) / (rangeInfo.drawOut[1] - rangeInfo.drawOut[0]);\n    if (drawCX < 0) drawCX = 0;else if (drawCX > canv1W) drawCX = canv1W;\n    if (drawIX < 0) drawIX = 0;else if (drawIX > rangeInfo.drawRangeX[1] - rangeInfo.drawRangeX[0]) drawIX = rangeInfo.drawRangeX[1] - rangeInfo.drawRangeX[0];\n    console.log(drawCX);\n    ctx.drawImage(paintImg, rangeInfo.drawRangeX[0] + drawIX, rangeInfo.drawRangeY[0], rangeInfo.drawRangeX[1] - (rangeInfo.drawRangeX[0] + drawIX), rangeInfo.drawRangeY[1] - rangeInfo.drawRangeY[0], drawCX, 0, canv1W - drawCX, canv1H);\n  }\n};\nconst drawS1 = (sRatio, ctx, scene, imgs) => {\n  const {\n    img1,\n    img2,\n    img3,\n    img4\n  } = scene;\n  paintImage(sRatio, ctx, img1, imgs[imgArr[0]].img);\n  paintImage(sRatio, ctx, img2, imgs[imgArr[1]].img);\n  paintImage(sRatio, ctx, img3, imgs[imgArr[2]].img);\n  paintImage(sRatio, ctx, img4, imgs[imgArr[3]].img);\n};\nconst s1ImgSizing = (vWidth, vHeight, imgs) => {\n  const whRatio = vWidth / vHeight;\n  // img draw Range - img1, img2\n  imgs.forEach(i => {\n    const imgVHRatio = i.width / i.height;\n    if (whRatio < imgVHRatio) {\n      const fixedScaleRatio = vHeight / i.height;\n      const fixedWidth = i.width * fixedScaleRatio;\n      const xDiff = (fixedWidth - vWidth) / fixedScaleRatio / 2;\n      sceneActive.s1[i.name].drawRangeX = [xDiff, i.width - xDiff];\n      sceneActive.s1[i.name].drawRangeY = [0, i.height];\n    } else {\n      const fixedScaleRatio = vWidth / i.width;\n      const fixedHeight = i.height * fixedScaleRatio;\n      const yDiff = (fixedHeight - vHeight) / fixedScaleRatio / 2;\n      sceneActive.s1[i.name].drawRangeX = [0, i.width];\n      sceneActive.s1[i.name].drawRangeY = [yDiff, i.height - yDiff];\n    }\n  });\n};\nconst drawMessage = (sRatio, currentScene, mp, setmp, vheight) => {\n  const sceneMessage = sceneActive[`s${currentScene + 1}`].messages;\n  const newMessagePosition = {\n    s1: []\n  };\n  sceneMessage.forEach((message, index) => {\n    const border = (message.opIn[1] + message.opOut[0]) / 2;\n    let opacity;\n    let top;\n    if (sRatio < border) {\n      opacity = (sRatio - message.opIn[0]) / (message.opIn[1] - message.opIn[0]);\n      if (opacity < 0) opacity = 0;else if (opacity > 1) opacity = 1;\n      top = message.trIn[0] + (message.trIn[1] - message.trIn[0]) * opacity;\n    } else {\n      opacity = 1 - (sRatio - message.opOut[0]) / (message.opOut[1] - message.opOut[0]);\n      if (opacity < 0) opacity = 0;else if (opacity > 1) opacity = 1;\n      top = message.trOut[0] + (message.trOut[1] - message.trOut[0]) * (1 - opacity);\n    }\n    newMessagePosition[`s${currentScene + 1}`].push({\n      ...mp[index],\n      top: `${vheight / 2 + top}px`,\n      opacity\n    });\n  });\n  setmp(newMessagePosition);\n};\nconst activeScene = (currentscene, sRatio, ctx, imgs, mp, setmp, vheight) => {\n  switch (currentscene) {\n    case 0:\n      drawS1(sRatio, ctx, sceneActive.s1, imgs);\n      drawMessage(sRatio, currentscene, mp, setmp, vheight);\n      break;\n    default:\n  }\n};\nconst messagePositionInitial = (vWidth, vHeight, setMessagePosition) => {\n  const newStyles = {\n    s1: []\n  };\n  for (let i = 0; i < sceneActive.s1.messages.length; i++) {\n    newStyles.s1.push({\n      top: `${vHeight / 2}px`,\n      opacity: 0\n    });\n  }\n  setMessagePosition(newStyles);\n};\nexport default function Preview({\n  size\n}) {\n  _s();\n  const vRef = useRef();\n  const cRef = useRef();\n  const s1Ref = useRef();\n  const [isLoading, setIsLoading] = useState(true);\n  const [imgs, setImgs] = useState({});\n  const [messagePosition, setMessagePosition] = useState({\n    s1: [defaultMessageStyle, defaultMessageStyle, defaultMessageStyle, defaultMessageStyle, defaultMessageStyle]\n  });\n  useEffect(() => {\n    if (!vRef || !cRef || !s1Ref || isLoading) return;\n\n    //height 고정, 그에 대한 width 보정\n    const vContainer = vRef.current;\n    // canvas acitve\n    const ctx = cRef.current.getContext('2d');\n\n    // canvas sizing(for scene1)\n    // s1 - img1 - 4\n    const pHeight = vContainer.parentNode.offsetHeight;\n    const whRatio = size.width / size.height;\n    const vHeight = pHeight * 8 / 10;\n    const vWidth = vHeight * whRatio;\n    vContainer.style.width = `${vWidth}px`;\n    vContainer.style.height = `${vHeight}px`;\n    canv1W = cRef.current.width = vWidth;\n    canv1H = cRef.current.height = vHeight;\n    messagePositionInitial(vWidth, vHeight, setMessagePosition);\n    s1ImgSizing(vWidth, vHeight, [imgs[img1], imgs[img2], imgs[img3], imgs[img4]]);\n    s1Ref.current.style.height = vHeight * s1HeightSize + 'px';\n    heightArr[0] = vHeight * s1HeightSize;\n    const handleViewScroll = e => {\n      // calculate scrollY\n      const vTop = e.target.getBoundingClientRect().top;\n      const sTop = s1Ref.current.getBoundingClientRect().top;\n      const scrollY = vTop - sTop;\n      let currentScene = 0;\n      let tempHeightVal = scrollY;\n      let currentStartY = 0;\n      // check current scene\n      for (let i = 0; i < heightArr.length; i++) {\n        tempHeightVal -= heightArr[i];\n        if (tempHeightVal < 0) break;else {\n          currentScene++;\n          currentStartY += heightArr[i];\n        }\n      }\n      const sRatio = (scrollY - currentStartY) / heightArr[currentScene];\n      ctx.clearRect(0, 0, canv1W, canv1H);\n      activeScene(currentScene, sRatio, ctx, imgs, messagePosition, setMessagePosition, vHeight);\n    };\n    vContainer.addEventListener('scroll', handleViewScroll);\n    return () => {\n      vContainer.removeEventListener('scroll', handleViewScroll);\n    };\n  }, [vRef, size, cRef, s1Ref, isLoading, imgs]);\n\n  // Src Loading\n  useEffect(() => {\n    // src Uploading\n    imgArr.forEach((path, index) => {\n      const img = new Image();\n      img.src = path;\n      img.onload = () => {\n        setImgs(prev => {\n          return {\n            ...prev,\n            [path]: {\n              name: `img${index + 1}`,\n              img,\n              path,\n              width: img.naturalWidth,\n              height: img.naturalHeight\n            }\n          };\n        });\n      };\n    });\n    const onWindowLoad = () => {\n      setIsLoading(false);\n    };\n    window.addEventListener('load', onWindowLoad);\n    return () => {\n      window.removeEventListener('load', onWindowLoad);\n    };\n  }, []);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    ref: vRef,\n    className: Styles.container,\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      ref: s1Ref,\n      className: Styles.s1,\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: Styles.intro_img,\n        children: /*#__PURE__*/_jsxDEV(\"img\", {\n          src: sceneActive.s1.intro.img,\n          alt: \"\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 361,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 360,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: Styles.sticky_box,\n        children: [/*#__PURE__*/_jsxDEV(\"canvas\", {\n          ref: cRef,\n          className: `${Styles.s1_canvas}`\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 364,\n          columnNumber: 21\n        }, this), sceneActive.s1.messages.map((message, index) => {\n          return /*#__PURE__*/_jsxDEV(\"div\", {\n            className: Styles.s1message,\n            style: {\n              ...messagePosition.s1[index]\n            },\n            children: message.context\n          }, index, false, {\n            fileName: _jsxFileName,\n            lineNumber: 371,\n            columnNumber: 29\n          }, this);\n        })]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 363,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 359,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 358,\n    columnNumber: 9\n  }, this);\n}\n_s(Preview, \"WjcVFGpdTepCpbkIWgW9fVFTctA=\");\n_c = Preview;\nvar _c;\n$RefreshReg$(_c, \"Preview\");","map":{"version":3,"names":["React","useRef","useEffect","useState","Styles","img1","img2","img3","img4","img5","img6","img7","img8","jsxDEV","_jsxDEV","imgArr","heightArr","canv1W","canv1H","defaultMessageStyle","top","opacity","s1HeightSize","sceneActive","s1","intro","img","opAction","opacityIn","opacityOut","opacityInRatio","opacityOutRatio","drawRangeX","drawRangeY","drawIn","drawOut","messages","context","opIn","opOut","trIn","trOut","color","size","sort","paintImage","sRatio","ctx","rangeInfo","paintImg","paintingBorder","drawCX","drawIX","drawImage","console","log","drawS1","scene","imgs","s1ImgSizing","vWidth","vHeight","whRatio","forEach","i","imgVHRatio","width","height","fixedScaleRatio","fixedWidth","xDiff","name","fixedHeight","yDiff","drawMessage","currentScene","mp","setmp","vheight","sceneMessage","newMessagePosition","message","index","border","push","activeScene","currentscene","messagePositionInitial","setMessagePosition","newStyles","length","Preview","_s","vRef","cRef","s1Ref","isLoading","setIsLoading","setImgs","messagePosition","vContainer","current","getContext","pHeight","parentNode","offsetHeight","style","handleViewScroll","e","vTop","target","getBoundingClientRect","sTop","scrollY","tempHeightVal","currentStartY","clearRect","addEventListener","removeEventListener","path","Image","src","onload","prev","naturalWidth","naturalHeight","onWindowLoad","window","ref","className","container","children","intro_img","alt","fileName","_jsxFileName","lineNumber","columnNumber","sticky_box","s1_canvas","map","s1message","_c","$RefreshReg$"],"sources":["D:/Github/KaKao/harry/src/components/createSection/Preview.jsx"],"sourcesContent":["import React, { useRef, useEffect, useState } from 'react'\r\nimport Styles from './preview.module.css'\r\n\r\nimport img1 from '../../imgs/img1.png'\r\nimport img2 from '../../imgs/img2.png'\r\nimport img3 from '../../imgs/img3.png'\r\nimport img4 from '../../imgs/img4.png'\r\nimport img5 from '../../imgs/img5.png'\r\nimport img6 from '../../imgs/img6.png'\r\nimport img7 from '../../imgs/img7.png'\r\nimport img8 from '../../imgs/img8.png'\r\n\r\nconst imgArr = [img1, img2, img3, img4, img5, img6, img7, img8]\r\nconst heightArr = []\r\nlet canv1W\r\nlet canv1H\r\nconst defaultMessageStyle = { top: `0px`, opacity: 0 }\r\nconst s1HeightSize = 5\r\n\r\nconst sceneActive = {\r\n    s1: {\r\n        intro: {\r\n            img: img8,\r\n        },\r\n        opAction: {\r\n            opacityIn: [0, 1],\r\n            opacityOut: [1, 0],\r\n            opacityInRatio: [0, 0.1],\r\n            opacityOutRatio: [0.9, 1],\r\n        },\r\n        img1: {\r\n            drawRangeX: '',\r\n            drawRangeY: '',\r\n            drawIn: [0.15, 0.2],\r\n            drawOut: [0.3, 0.4],\r\n        },\r\n        img2: {\r\n            drawRangeX: '',\r\n            drawRangeY: '',\r\n            drawIn: [0.35, 0.4],\r\n            drawOut: [0.5, 0.6],\r\n        },\r\n        img3: {\r\n            drawRangeX: '',\r\n            drawRangeY: '',\r\n            drawIn: [0.55, 0.6],\r\n            drawOut: [0.65, 0.75],\r\n        },\r\n        img4: {\r\n            drawRangeX: '',\r\n            drawRangeY: '',\r\n            drawIn: [0.7, 0.75],\r\n            drawOut: [0.8, 0.85],\r\n        },\r\n        messages: [\r\n            {\r\n                context: 'hello!',\r\n                opIn: [0, 0.05],\r\n                opOut: [0.15, 0.2],\r\n                trIn: [20, 0],\r\n                trOut: [0, -20],\r\n                color: 'black',\r\n                size: 'large',\r\n                sort: 'middle',\r\n            },\r\n            {\r\n                context: '잘 지냄 수과',\r\n                opIn: [0.2, 0.25],\r\n                opOut: [0.35, 0.4],\r\n                trIn: [20, 0],\r\n                trOut: [0, -20],\r\n                color: 'black',\r\n                size: 'large',\r\n                sort: 'middle',\r\n            },\r\n            {\r\n                context: '나도 잘 지내영',\r\n                opIn: [0.4, 0.45],\r\n                opOut: [0.55, 0.6],\r\n                trIn: [20, 0],\r\n                trOut: [0, -20],\r\n                color: 'black',\r\n                size: 'large',\r\n                sort: 'middle',\r\n            },\r\n            {\r\n                context: '잘 지냄 수과',\r\n                opIn: [0.6, 0.65],\r\n                opOut: [0.75, 0.8],\r\n                trIn: [20, 0],\r\n                trOut: [0, -20],\r\n                color: 'black',\r\n                size: 'large',\r\n                sort: 'middle',\r\n            },\r\n        ],\r\n    },\r\n}\r\n\r\nconst paintImage = (sRatio, ctx, rangeInfo, paintImg) => {\r\n    const paintingBorder = (rangeInfo.drawIn[1] + rangeInfo.drawOut[0]) / 2\r\n    if (sRatio < paintingBorder) {\r\n        let drawCX =\r\n            (canv1W * (sRatio - rangeInfo.drawIn[0])) /\r\n            (rangeInfo.drawIn[1] - rangeInfo.drawIn[0])\r\n\r\n        let drawIX =\r\n            ((rangeInfo.drawRangeX[1] - rangeInfo.drawRangeX[0]) *\r\n                (sRatio - rangeInfo.drawIn[0])) /\r\n            (rangeInfo.drawIn[1] - rangeInfo.drawIn[0])\r\n        if (drawCX < 0) drawCX = 0\r\n        else if (drawCX > canv1W) drawCX = canv1W\r\n\r\n        if (drawIX < 0) drawIX = 0\r\n        else if (drawIX > rangeInfo.drawRangeX[1] - rangeInfo.drawRangeX[0])\r\n            drawIX = rangeInfo.drawRangeX[1] - rangeInfo.drawRangeX[0]\r\n        ctx.drawImage(\r\n            paintImg,\r\n            rangeInfo.drawRangeX[0],\r\n            rangeInfo.drawRangeY[0],\r\n            drawIX,\r\n            rangeInfo.drawRangeY[1] - rangeInfo.drawRangeY[0],\r\n            0,\r\n            0,\r\n            drawCX,\r\n            canv1H,\r\n        )\r\n    } else {\r\n        let drawCX =\r\n            (canv1W * (sRatio - rangeInfo.drawOut[0])) /\r\n            (rangeInfo.drawOut[1] - rangeInfo.drawOut[0])\r\n        let drawIX =\r\n            ((rangeInfo.drawRangeX[1] - rangeInfo.drawRangeX[0]) *\r\n                (sRatio - rangeInfo.drawOut[0])) /\r\n            (rangeInfo.drawOut[1] - rangeInfo.drawOut[0])\r\n        if (drawCX < 0) drawCX = 0\r\n        else if (drawCX > canv1W) drawCX = canv1W\r\n\r\n        if (drawIX < 0) drawIX = 0\r\n        else if (drawIX > rangeInfo.drawRangeX[1] - rangeInfo.drawRangeX[0])\r\n            drawIX = rangeInfo.drawRangeX[1] - rangeInfo.drawRangeX[0]\r\n        console.log(drawCX)\r\n        ctx.drawImage(\r\n            paintImg,\r\n            rangeInfo.drawRangeX[0] + drawIX,\r\n            rangeInfo.drawRangeY[0],\r\n            rangeInfo.drawRangeX[1] - (rangeInfo.drawRangeX[0] + drawIX),\r\n            rangeInfo.drawRangeY[1] - rangeInfo.drawRangeY[0],\r\n            drawCX,\r\n            0,\r\n            canv1W - drawCX,\r\n            canv1H,\r\n        )\r\n    }\r\n}\r\n\r\nconst drawS1 = (sRatio, ctx, scene, imgs) => {\r\n    const { img1, img2, img3, img4 } = scene\r\n\r\n    paintImage(sRatio, ctx, img1, imgs[imgArr[0]].img)\r\n    paintImage(sRatio, ctx, img2, imgs[imgArr[1]].img)\r\n    paintImage(sRatio, ctx, img3, imgs[imgArr[2]].img)\r\n    paintImage(sRatio, ctx, img4, imgs[imgArr[3]].img)\r\n}\r\n\r\nconst s1ImgSizing = (vWidth, vHeight, imgs) => {\r\n    const whRatio = vWidth / vHeight\r\n    // img draw Range - img1, img2\r\n    imgs.forEach((i) => {\r\n        const imgVHRatio = i.width / i.height\r\n        if (whRatio < imgVHRatio) {\r\n            const fixedScaleRatio = vHeight / i.height\r\n            const fixedWidth = i.width * fixedScaleRatio\r\n            const xDiff = (fixedWidth - vWidth) / fixedScaleRatio / 2\r\n            sceneActive.s1[i.name].drawRangeX = [xDiff, i.width - xDiff]\r\n            sceneActive.s1[i.name].drawRangeY = [0, i.height]\r\n        } else {\r\n            const fixedScaleRatio = vWidth / i.width\r\n            const fixedHeight = i.height * fixedScaleRatio\r\n            const yDiff = (fixedHeight - vHeight) / fixedScaleRatio / 2\r\n            sceneActive.s1[i.name].drawRangeX = [0, i.width]\r\n            sceneActive.s1[i.name].drawRangeY = [yDiff, i.height - yDiff]\r\n        }\r\n    })\r\n}\r\n\r\nconst drawMessage = (sRatio, currentScene, mp, setmp, vheight) => {\r\n    const sceneMessage = sceneActive[`s${currentScene + 1}`].messages\r\n    const newMessagePosition = { s1: [] }\r\n    sceneMessage.forEach((message, index) => {\r\n        const border = (message.opIn[1] + message.opOut[0]) / 2\r\n        let opacity\r\n        let top\r\n        if (sRatio < border) {\r\n            opacity =\r\n                (sRatio - message.opIn[0]) / (message.opIn[1] - message.opIn[0])\r\n            if (opacity < 0) opacity = 0\r\n            else if (opacity > 1) opacity = 1\r\n            top =\r\n                message.trIn[0] + (message.trIn[1] - message.trIn[0]) * opacity\r\n        } else {\r\n            opacity =\r\n                1 -\r\n                (sRatio - message.opOut[0]) /\r\n                    (message.opOut[1] - message.opOut[0])\r\n            if (opacity < 0) opacity = 0\r\n            else if (opacity > 1) opacity = 1\r\n            top =\r\n                message.trOut[0] +\r\n                (message.trOut[1] - message.trOut[0]) * (1 - opacity)\r\n        }\r\n\r\n        newMessagePosition[`s${currentScene + 1}`].push({\r\n            ...mp[index],\r\n            top: `${vheight / 2 + top}px`,\r\n            opacity,\r\n        })\r\n    })\r\n    setmp(newMessagePosition)\r\n}\r\n\r\nconst activeScene = (currentscene, sRatio, ctx, imgs, mp, setmp, vheight) => {\r\n    switch (currentscene) {\r\n        case 0:\r\n            drawS1(sRatio, ctx, sceneActive.s1, imgs)\r\n            drawMessage(sRatio, currentscene, mp, setmp, vheight)\r\n            break\r\n        default:\r\n    }\r\n}\r\nconst messagePositionInitial = (vWidth, vHeight, setMessagePosition) => {\r\n    const newStyles = {\r\n        s1: [],\r\n    }\r\n    for (let i = 0; i < sceneActive.s1.messages.length; i++) {\r\n        newStyles.s1.push({ top: `${vHeight / 2}px`, opacity: 0 })\r\n    }\r\n    setMessagePosition(newStyles)\r\n}\r\n\r\nexport default function Preview({ size }) {\r\n    const vRef = useRef()\r\n    const cRef = useRef()\r\n    const s1Ref = useRef()\r\n    const [isLoading, setIsLoading] = useState(true)\r\n    const [imgs, setImgs] = useState({})\r\n    const [messagePosition, setMessagePosition] = useState({\r\n        s1: [\r\n            defaultMessageStyle,\r\n            defaultMessageStyle,\r\n            defaultMessageStyle,\r\n            defaultMessageStyle,\r\n            defaultMessageStyle,\r\n        ],\r\n    })\r\n\r\n    useEffect(() => {\r\n        if (!vRef || !cRef || !s1Ref || isLoading) return\r\n\r\n        //height 고정, 그에 대한 width 보정\r\n        const vContainer = vRef.current\r\n        // canvas acitve\r\n        const ctx = cRef.current.getContext('2d')\r\n\r\n        // canvas sizing(for scene1)\r\n        // s1 - img1 - 4\r\n        const pHeight = vContainer.parentNode.offsetHeight\r\n\r\n        const whRatio = size.width / size.height\r\n\r\n        const vHeight = (pHeight * 8) / 10\r\n        const vWidth = vHeight * whRatio\r\n        vContainer.style.width = `${vWidth}px`\r\n        vContainer.style.height = `${vHeight}px`\r\n        canv1W = cRef.current.width = vWidth\r\n        canv1H = cRef.current.height = vHeight\r\n        messagePositionInitial(vWidth, vHeight, setMessagePosition)\r\n        s1ImgSizing(vWidth, vHeight, [\r\n            imgs[img1],\r\n            imgs[img2],\r\n            imgs[img3],\r\n            imgs[img4],\r\n        ])\r\n\r\n        s1Ref.current.style.height = vHeight * s1HeightSize + 'px'\r\n        heightArr[0] = vHeight * s1HeightSize\r\n\r\n        const handleViewScroll = (e) => {\r\n            // calculate scrollY\r\n            const vTop = e.target.getBoundingClientRect().top\r\n            const sTop = s1Ref.current.getBoundingClientRect().top\r\n            const scrollY = vTop - sTop\r\n\r\n            let currentScene = 0\r\n            let tempHeightVal = scrollY\r\n            let currentStartY = 0\r\n            // check current scene\r\n            for (let i = 0; i < heightArr.length; i++) {\r\n                tempHeightVal -= heightArr[i]\r\n                if (tempHeightVal < 0) break\r\n                else {\r\n                    currentScene++\r\n                    currentStartY += heightArr[i]\r\n                }\r\n            }\r\n            const sRatio = (scrollY - currentStartY) / heightArr[currentScene]\r\n            ctx.clearRect(0, 0, canv1W, canv1H)\r\n            activeScene(\r\n                currentScene,\r\n                sRatio,\r\n                ctx,\r\n                imgs,\r\n                messagePosition,\r\n                setMessagePosition,\r\n                vHeight,\r\n            )\r\n        }\r\n\r\n        vContainer.addEventListener('scroll', handleViewScroll)\r\n\r\n        return () => {\r\n            vContainer.removeEventListener('scroll', handleViewScroll)\r\n        }\r\n    }, [vRef, size, cRef, s1Ref, isLoading, imgs])\r\n\r\n    // Src Loading\r\n    useEffect(() => {\r\n        // src Uploading\r\n        imgArr.forEach((path, index) => {\r\n            const img = new Image()\r\n            img.src = path\r\n            img.onload = () => {\r\n                setImgs((prev) => {\r\n                    return {\r\n                        ...prev,\r\n                        [path]: {\r\n                            name: `img${index + 1}`,\r\n                            img,\r\n                            path,\r\n                            width: img.naturalWidth,\r\n                            height: img.naturalHeight,\r\n                        },\r\n                    }\r\n                })\r\n            }\r\n        })\r\n\r\n        const onWindowLoad = () => {\r\n            setIsLoading(false)\r\n        }\r\n        window.addEventListener('load', onWindowLoad)\r\n        return () => {\r\n            window.removeEventListener('load', onWindowLoad)\r\n        }\r\n    }, [])\r\n\r\n    return (\r\n        <div ref={vRef} className={Styles.container}>\r\n            <div ref={s1Ref} className={Styles.s1}>\r\n                <div className={Styles.intro_img}>\r\n                    <img src={sceneActive.s1.intro.img} alt=\"\" />\r\n                </div>\r\n                <div className={Styles.sticky_box}>\r\n                    <canvas\r\n                        ref={cRef}\r\n                        className={`${Styles.s1_canvas}`}\r\n                    ></canvas>\r\n\r\n                    {sceneActive.s1.messages.map((message, index) => {\r\n                        return (\r\n                            <div\r\n                                key={index}\r\n                                className={Styles.s1message}\r\n                                style={{ ...messagePosition.s1[index] }}\r\n                            >\r\n                                {message.context}\r\n                            </div>\r\n                        )\r\n                    })}\r\n                </div>\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}